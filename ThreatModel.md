# Threatspec Project Threat Model

A threatspec project.


# Diagram
![Threat Model Diagram](ThreatModel.md.png)



# Exposures

## Out of scope against guest
Cannot change

```
# @exposes #guest to Out of scope with cannot change



@app.route('/')
def home():

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Out of scope against Internet:AuthenticatedUser
Cannot change

```
# @exposes #auser to Out of scope with cannot change



@app.route('/')
def home():

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Javascript manipulation against Server:/home
#xss

```
# @exposes #home to javascript manipulation with #xss

@app.route('/')
def home():
    return render_template('home.html')


```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Privilege escalation against Server:/login
#brute

```
# @exposes #login to privilege escalation with #brute


@app.route('/register', methods=["GET", "POST"])
def register():
    if request.method == 'GET':

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Information disclosure against Server:/logout
#brute

```
# @exposes #logout to information disclosure with #brute


@app.route('/register', methods=["GET", "POST"])
def register():
    if request.method == 'GET':

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Information disclosure against Internet:AuthenticatedUser
#brute

```
# @exposes #auser to information disclosure with #brute


@app.route('/register', methods=["GET", "POST"])
def register():
    if request.method == 'GET':

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Sql injection against Server:/createUser
#sqlinjection

```
# @exposes #createuser to #sqlinjection with #sqlinjection

@app.route('/register', methods=["GET", "POST"])
def register():
    if request.method == 'GET':
        return render_template("register.html")

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1


# Acceptances


# Transfers


# Mitigations


# Reviews


# Connections

## guest To Server:/home
HTTP-GET

```
# @connects #guest to #home with HTTP-GET


@app.route('/')
def home():
    return render_template('home.html')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/home To guest
HTTP-GET

```
# @connects #home to guest with HTTP-GET


@app.route('/')
def home():
    return render_template('home.html')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Internet:AuthenticatedUser To Server:/home
HTTP-POST

```
# @connects #auser to #home with HTTP-POST


@app.route('/')
def home():
    return render_template('home.html')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/home To Internet:AuthenticatedUser
HTTP-POST

```
# @connects #home to #auser with HTTP-POST


@app.route('/')
def home():
    return render_template('home.html')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/home With Server:/register
Links

```
# @connects #home with #register with Links



@app.route('/register', methods=["GET", "POST"])
def register():

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## guest To Server:/register
HTTP-POST

```
# @connects #guest to #register with HTTP-POST



@app.route('/register', methods=["GET", "POST"])
def register():

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/register To guest
HTTP-POST

```
# @connects #register to #guest with HTTP-POST



@app.route('/register', methods=["GET", "POST"])
def register():

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/home To Server:/login
Links

```
# @connects #home to #login with Links
@app.route('/login')
def login_page():
    return render_template('login.html')

@app.route('/authenticate')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## guest To Server:/login
HTTP-POST

```
# @connects #guest to #login with HTTP-POST
@app.route('/login')
def login_page():
    return render_template('login.html')

@app.route('/authenticate')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/login To guest
HTTP-POST

```
# @connects #login to #guest with HTTP-POST
@app.route('/login')
def login_page():
    return render_template('login.html')

@app.route('/authenticate')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/login To Server:/authenticate
Links

```
# @connects #login to #authenticate with Links
@app.route('/authenticate')

@app.route('/logout')

@app.route('/user')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Internet:AuthenticatedUser To Server:/authenticate
HTTP-POST

```
# @connects #auser to #authenticate with HTTP-POST
@app.route('/authenticate')

@app.route('/logout')

@app.route('/user')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/authenticate To Internet:AuthenticatedUser
HTTP-POST

```
# @connects #authenticate to #auser with HTTP-POST
@app.route('/authenticate')

@app.route('/logout')

@app.route('/user')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/home To Server:/logout
Links

```
# @connects #home to #logout with Links
@app.route('/logout')

@app.route('/user')
def user_index():
    return "This is the User Index page"

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Internet:AuthenticatedUser To Server:/logout
HTTP-POST

```
# @connects #auser to #logout with HTTP-POST
@app.route('/logout')

@app.route('/user')
def user_index():
    return "This is the User Index page"

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/logout To Internet:AuthenticatedUser
HTTP-POST

```
# @connects #logout to #auser with HTTP-POST
@app.route('/logout')

@app.route('/user')
def user_index():
    return "This is the User Index page"

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/home To Server:/user
Links

```
# @connects #home to #user with Links
@app.route('/user')
def user_index():
    return "This is the User Index page"

@app.route('/user/vulnerability_scanner')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Internet:AuthenticatedUser To Server:/user
HTTP-GET

```
# @connects #auser to #user with HTTP-GET
@app.route('/user')
def user_index():
    return "This is the User Index page"

@app.route('/user/vulnerability_scanner')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/user To Internet:AuthenticatedUser
HTTP-GET

```
# @connects #user to #auser with HTTP-GET
@app.route('/user')
def user_index():
    return "This is the User Index page"

@app.route('/user/vulnerability_scanner')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/user To Server:/scanner
Links

```
# @connects #user to #scanner with Links
@app.route('/user/vulnerability_scanner')
def user_vulnerability_scanner():
    return "This is the User Vulnerability Scanner page"

@app.route('/admin')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Internet:AuthenticatedUser To Server:/scanner
HTTP-POST

```
# @connects #auser to #scanner with HTTP-POST
@app.route('/user/vulnerability_scanner')
def user_vulnerability_scanner():
    return "This is the User Vulnerability Scanner page"

@app.route('/admin')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/scanner To Internet:AuthenticatedUser
HTTP-GET

```
# @connects #scanner to #auser with HTTP-GET
@app.route('/user/vulnerability_scanner')
def user_vulnerability_scanner():
    return "This is the User Vulnerability Scanner page"

@app.route('/admin')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/home To Server:/admin
Links

```
# @connects #home to #admin with Links
@app.route('/admin')
def admin_index():
    return "This is the Admin Index page"

@app.route('/create_user')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## sysadmin To Server:/admin
HTTP-POST

```
# @connects #sysadmin to #admin with HTTP-POST
@app.route('/admin')
def admin_index():
    return "This is the Admin Index page"

@app.route('/create_user')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/admin To sysadmin
HTTP-POST

```
# @connects #admin to #sysadmin with HTTP-POST
@app.route('/admin')
def admin_index():
    return "This is the Admin Index page"

@app.route('/create_user')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/admin To #create user
Links

```
# @connects #admin to #create user with Links
@app.route('/create_user')
def admin_create_users():
    return "This is an admin priviledge page to create users"



```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## sysadmin To Server:/createUser
HTTP-POST

```
# @connects #sysadmin to #createuser with HTTP-POST
@app.route('/create_user')
def admin_create_users():
    return "This is an admin priviledge page to create users"



```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/createUser To sysadmin
HTTP-POST

```
# @connects #createuser to #sysadmin with HTTP-POST
@app.route('/create_user')
def admin_create_users():
    return "This is an admin priviledge page to create users"



```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/admin To Server:/createpass
Links

```
# @connects #admin to #createpass with Links
@app.route('/createpass')

@flaskapp.route('/success', methods=['GET'])
def success():
    return render_template('success.html')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## sysadmin To Server:/createpass
HTTP-POST

```
# @connects #sysadmin to #createpass with HTTP-POST
@app.route('/createpass')

@flaskapp.route('/success', methods=['GET'])
def success():
    return render_template('success.html')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/createpass To sysadmin
HTTP-POST

```
# @connects #createpass to #sysadmin with HTTP-POST
@app.route('/createpass')

@flaskapp.route('/success', methods=['GET'])
def success():
    return render_template('success.html')

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/createpass To Server:/success
Links

```
# @connects #createpass to #success with Links
@flaskapp.route('/success', methods=['GET'])
def success():
    return render_template('success.html')

@flaskapp.route('/sendemail', methods = ['POST'])

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## sysadmin To Server:/success
HTTP-GET

```
# @connects #sysadmin to #success with HTTP-GET
@flaskapp.route('/success', methods=['GET'])
def success():
    return render_template('success.html')

@flaskapp.route('/sendemail', methods = ['POST'])

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/success To sysadmin
HTTP-GET

```
# @connects #success to sysadmin with HTTP-GET
@flaskapp.route('/success', methods=['GET'])
def success():
    return render_template('success.html')

@flaskapp.route('/sendemail', methods = ['POST'])

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/admin To Server:/sendemail
Links

```
# @connects #admin to #sendemail with Links
@flaskapp.route('/sendemail', methods = ['POST'])

@flaskapp.route('/resetpass', methods=['POST','GET'])

@flaskapp.route('/dashboard', methods=['POST','GET'])

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## sysadmin To Server:/sendemail
HTTP-POST

```
# @connects #sysadmin to #sendemail with HTTP-POST
@flaskapp.route('/sendemail', methods = ['POST'])

@flaskapp.route('/resetpass', methods=['POST','GET'])

@flaskapp.route('/dashboard', methods=['POST','GET'])

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/sendemail To sysadmin
HTTP-GET

```
# @connects #sendemail to #sysadmin with HTTP-GET
@flaskapp.route('/sendemail', methods = ['POST'])

@flaskapp.route('/resetpass', methods=['POST','GET'])

@flaskapp.route('/dashboard', methods=['POST','GET'])

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/admin To Server:/resetpass
Links

```
# @connects #admin to #resetpass with Links
@flaskapp.route('/resetpass', methods=['POST','GET'])

@flaskapp.route('/dashboard', methods=['POST','GET'])

@flaskapp.route('/dashboard/new_project', methods = ['POST'])

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## sysadmin To Server:/resetpass
HTTP-POST

```
# @connects #sysadmin to #resetpass with HTTP-POST
@flaskapp.route('/resetpass', methods=['POST','GET'])

@flaskapp.route('/dashboard', methods=['POST','GET'])

@flaskapp.route('/dashboard/new_project', methods = ['POST'])

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/resetpass To sysadmin
HTTP-GET

```
# @connects #resetpass to #sysadmin with HTTP-GET
@flaskapp.route('/resetpass', methods=['POST','GET'])

@flaskapp.route('/dashboard', methods=['POST','GET'])

@flaskapp.route('/dashboard/new_project', methods = ['POST'])

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/admin To dashboard
Links

```
# @connects #admin to #dashboard with Links
@flaskapp.route('/dashboard', methods=['POST','GET'])

@flaskapp.route('/dashboard/new_project', methods = ['POST'])

@flaskapp.route('/dashboard/delete_project', methods = ['POST'])

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## sysadmin To dashboard
HTTP-GET

```
# @connects #sysadmin to #dashboard with HTTP-GET
@flaskapp.route('/dashboard', methods=['POST','GET'])

@flaskapp.route('/dashboard/new_project', methods = ['POST'])

@flaskapp.route('/dashboard/delete_project', methods = ['POST'])

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## dashboard To sysadmin
HTTP-GET

```
# @connects #dashboard to #sysadmin with HTTP-GET
@flaskapp.route('/dashboard', methods=['POST','GET'])

@flaskapp.route('/dashboard/new_project', methods = ['POST'])

@flaskapp.route('/dashboard/delete_project', methods = ['POST'])

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## dashboard To Server:/dashboard/new_project
Links

```
# @connects #dashboard to #newproject with Links
@flaskapp.route('/dashboard/new_project', methods = ['POST'])

@flaskapp.route('/dashboard/delete_project', methods = ['POST'])

@flaskapp.route('/dashboard/add_underling', methods = ['POST'])

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## sysadmin To Server:/dashboard/new_project
HTTP-POST

```
# @connects #sysadmin to #newproject with HTTP-POST
@flaskapp.route('/dashboard/new_project', methods = ['POST'])

@flaskapp.route('/dashboard/delete_project', methods = ['POST'])

@flaskapp.route('/dashboard/add_underling', methods = ['POST'])

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## dashboard To Server:/dashboard/delete_project
Links

```
# @connects #dashboard to #deleteproject with Links
@flaskapp.route('/dashboard/delete_project', methods = ['POST'])

@flaskapp.route('/dashboard/add_underling', methods = ['POST'])

@flaskapp.route('/dashboard/del_underling', methods = ['POST'])

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## sysadmin To Server:/dashboard/delete_project
HTTP-POST

```
# @connects #sysadmin to #deleteproject with HTTP-POST
@flaskapp.route('/dashboard/delete_project', methods = ['POST'])

@flaskapp.route('/dashboard/add_underling', methods = ['POST'])

@flaskapp.route('/dashboard/del_underling', methods = ['POST'])

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## dashboard To Server:/dashboard/add_underling
Links

```
# @connects #dashboard to #addunderling with Links
@flaskapp.route('/dashboard/add_underling', methods = ['POST'])

@flaskapp.route('/dashboard/del_underling', methods = ['POST'])

if __name__ == '__main__':

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## sysadmin To Server:/dashboard/add_underling
HTTP-POST

```
# @connects #sysadmin to #addunderling with HTTP-POST
@flaskapp.route('/dashboard/add_underling', methods = ['POST'])

@flaskapp.route('/dashboard/del_underling', methods = ['POST'])

if __name__ == '__main__':

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## Server:/dashboard/add_underling To sysadmin
HTTP-POST

```
# @connects #addunderling to #sysadmin with HTTP-POST
@flaskapp.route('/dashboard/add_underling', methods = ['POST'])

@flaskapp.route('/dashboard/del_underling', methods = ['POST'])

if __name__ == '__main__':

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## dashboard To Server:/dashboard/del_underling
Links

```
# @connects dashboard to #delunderling with Links
@flaskapp.route('/dashboard/del_underling', methods = ['POST'])

if __name__ == '__main__':
    print("This is the web app")
    app.secret_key = "012#!jadfkiGg)(*%$"

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1

## sysadmin To Server:/dashboard/del_underling
HTTP-POST

```
# @connects #sysadmin to #delunderling with HTTP-POST
@flaskapp.route('/dashboard/del_underling', methods = ['POST'])

if __name__ == '__main__':
    print("This is the web app")
    app.secret_key = "012#!jadfkiGg)(*%$"

```
/home/kali/cyber/projects/final_project/threatspec/app/pages.py:1


# Components

## guest

## Internet:AuthenticatedUser

## Server:/home

## Server:/login

## Server:/logout

## Server:/createUser

## Server:/register

## Server:/authenticate

## Server:/user

## Server:/scanner

## Server:/admin

## sysadmin

## #create user

## Server:/createpass

## Server:/success

## Server:/sendemail

## Server:/resetpass

## dashboard

## Server:/dashboard/new_project

## Server:/dashboard/delete_project

## Server:/dashboard/add_underling

## Server:/dashboard/del_underling


# Threats

## Out of scope


## Javascript manipulation


## Privilege escalation


## Information disclosure


## Sql injection



# Controls
