# Threatspec Project Threat Model

A threatspec project.


# Diagram
![Threat Model Diagram](ThreatModel.md.png)



# Exposures

## Out of service against TerraformAWS:VPC:NACl_App:Subnet_App:Security_Group_App:EC2_Instance_App
Not using idp

```
# @exposes #ec2_app to Out of service with not using IDP




resource "aws_instance" "cyber94_vulnerability_scanner_app"{

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/app_server/main.tf:1

## Ip exposure against TerraformAWS:VPC:NACl_App:Subnet_App:Security_Group_App:EC2_Instance_App
Not using a dns server of proxy server

```
# @exposes #ec2_app to #ipexposure with not using a DNS server of proxy server



resource "aws_instance" "cyber94_vulnerability_scanner_app"{
  ami = "ami-0943382e114f188e8"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/app_server/main.tf:1

## Ip exposure against TerraformAWS:VPC:NACl_Bastion:Subnet_Bastion:Security_Group_Bastion:EC2_Instance_Bastion
Not using a dns server or proxy server

```
# @exposes #ec2_bastion to #ipexposure with not using a DNS server or proxy server

resource "aws_instance" "cyber94_vulnerability_scanner_bastion"{
  ami = "ami-0943382e114f188e8"
  instance_type = "t2.micro"
  key_name = "cyber94-bdeadfield"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/bastion_server/main.tf:1


# Acceptances


# Transfers


# Mitigations

## Ip exposure against TerraformAWS:VPC:NACl_Database:Subnet_Database:Security_Group_Database:EC2_Instance_Database mitigated by Not connected to public ip address or route table


```
# @mitigates #ec2_db against #ipexposure with #privateip

resource "aws_instance" "cyber94_vulnerability_scanner_db"{
  ami = "ami-0d1c7c4de1f4cdc9a"
  instance_type = "t2.micro"
  key_name = "cyber94-bdeadfield"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/database_server/main.tf:1

## Ip exposure against TerraformAWS:VPC:NACl_App:Subnet_App:Security_Group_App:EC2_Instance_App mitigated by Using dns for proxy server


```
# @mitigates #ec2_app against #ipexposure with using DNS for proxy server



resource "aws_instance" "cyber94_vulnerability_scanner_app"{
  ami = "ami-0943382e114f188e8"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/app_server/main.tf:1

## Port sniffing for open ports against TerraformAWS:VPC:NACl_App:Subnet_App:Security_Group_App:EC2_Instance_App mitigated by Only listen on needed ports


```
# @mitigates #ec2_app against #portsniff with #portsniffdefense


resource "aws_instance" "cyber94_vulnerability_scanner_app"{
  ami = "ami-0943382e114f188e8"
  instance_type = "t2.micro"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/app_server/main.tf:1

## Access to ec2_app allows access to database server against TerraformAWS:VPC:NACl_App:Subnet_App:Security_Group_App:EC2_Instance_App mitigated by Only allow ssh connections to ec2_app server from specific ip addresses


```
# @mitigates #ec2_app against #ec2_app_access with #ec2_app_protect

resource "aws_instance" "cyber94_vulnerability_scanner_app"{
  ami = "ami-0943382e114f188e8"
  instance_type = "t2.micro"
  key_name = var.var_ssh_key_name

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/app_server/main.tf:1

## Intruder ssh connection against TerraformAWS:VPC:NACl_Bastion:Subnet_Bastion:Security_Group_Bastion:EC2_Instance_Bastion mitigated by Nacl and security group ip check


```
# @mitigates #ec2_bastion against #ssh with #ip


resource "aws_instance" "cyber94_vulnerability_scanner_bastion"{
  ami = "ami-0943382e114f188e8"
  instance_type = "t2.micro"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/bastion_server/main.tf:1


# Reviews


# Connections

## TerraformAWS:VPC:Route_Table To TerraformAWS:VPC:NACl_Bastion:Subnet_Bastion
link

```
# @connects #rt to #subnet_bastion with link
resource "aws_route_table_association" "cyber94_vulnerability_scanner_rt_assoc_bastion_tf" {
    subnet_id = aws_subnet.cyber94_vulnerability_scanner_subnet_bastion_tf.id
    route_table_id = var.var_internet_rt
}


```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/bastion_subnet/main.tf:1

## TerraformAWS:VPC:NACl_Bastion:Subnet_Bastion To TerraformAWS:VPC:Route_Table
link

```
# @connects #subnet_bastion to #rt with link
resource "aws_route_table_association" "cyber94_vulnerability_scanner_rt_assoc_bastion_tf" {
    subnet_id = aws_subnet.cyber94_vulnerability_scanner_subnet_bastion_tf.id
    route_table_id = var.var_internet_rt
}


```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/bastion_subnet/main.tf:1

## TerraformAWS:VPC:NACl_Bastion To TerraformAWS:VPC:NACl_Bastion:Subnet_Bastion
SSH

```
# @connects #nacl_bastion to #subnet_bastion with SSH
resource "aws_network_acl" "cyber94_vulnerability_scanner_ncal_bastion_tf"{
  vpc_id = var.var_aws_vpc_id

  egress {
       protocol   = "tcp"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/bastion_subnet/main.tf:1

## TerraformAWS:VPC:NACl_Bastion:Subnet_Bastion To TerraformAWS:VPC:NACl_Bastion
SSH

```
# @connects #subnet_bastion to #nacl_bastion with SSH
resource "aws_network_acl" "cyber94_vulnerability_scanner_ncal_bastion_tf"{
  vpc_id = var.var_aws_vpc_id

  egress {
       protocol   = "tcp"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/bastion_subnet/main.tf:1

## TerraformAWS:VPC:NACl_Bastion To TerraformAWS:VPC:NACl_Database
SSH,HTTP,HTTPs

```
# @connects #nacl_bastion to #nacl_db with SSH,HTTP,HTTPs
resource "aws_network_acl" "cyber94_vulnerability_scanner_ncal_bastion_tf"{
  vpc_id = var.var_aws_vpc_id

  egress {
       protocol   = "tcp"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/bastion_subnet/main.tf:1

## TerraformAWS:VPC:NACl_Database To TerraformAWS:VPC:NACl_Bastion
SSH,HTTP,HTTPs

```
# @connects #nacl_db to #nacl_bastion with SSH,HTTP,HTTPs
resource "aws_network_acl" "cyber94_vulnerability_scanner_ncal_bastion_tf"{
  vpc_id = var.var_aws_vpc_id

  egress {
       protocol   = "tcp"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/bastion_subnet/main.tf:1

## Internet To Internet:developer_Computer
HTTP,HTTPs

```
# @connects #internet to #dev_pc with HTTP,HTTPs
resource "aws_vpc" "cyber94_vulnerability_scanner_vpc_tf"{
  cidr_block = "10.118.0.0/16"
  enable_dns_support = true
  enable_dns_hostnames = true


```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/vpc/main.tf:1

## Internet:developer_Computer To Internet
HTTP,HTTPs

```
# @connects #dev_pc to #internet with HTTP,HTTPs
resource "aws_vpc" "cyber94_vulnerability_scanner_vpc_tf"{
  cidr_block = "10.118.0.0/16"
  enable_dns_support = true
  enable_dns_hostnames = true


```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/vpc/main.tf:1

## TerraformAWS:VPC:Internet_Gateway To Internet
HTTP,HTTPs

```
# @connects #ig to #internet with HTTP,HTTPs
resource "aws_route_table" "cyber94_vulnerability_scanner_rt_tf"{
  vpc_id = aws_vpc.cyber94_vulnerability_scanner_vpc_tf.id
  route {
    cidr_block = "0.0.0.0/0"
    gateway_id = aws_internet_gateway.cyber94_vulnerability_scanner_ig_tf.id

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/vpc/main.tf:1

## Internet To TerraformAWS:VPC:Internet_Gateway
HTTP,HTTPs

```
# @connects #internet to #ig with HTTP,HTTPs
resource "aws_route_table" "cyber94_vulnerability_scanner_rt_tf"{
  vpc_id = aws_vpc.cyber94_vulnerability_scanner_vpc_tf.id
  route {
    cidr_block = "0.0.0.0/0"
    gateway_id = aws_internet_gateway.cyber94_vulnerability_scanner_ig_tf.id

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/vpc/main.tf:1

## TerraformAWS:VPC:Route_Table To TerraformAWS:VPC:Internet_Gateway
link

```
# @connects #rt to #ig with link
resource "aws_route_table" "cyber94_vulnerability_scanner_rt_tf"{
  vpc_id = aws_vpc.cyber94_vulnerability_scanner_vpc_tf.id
  route {
    cidr_block = "0.0.0.0/0"
    gateway_id = aws_internet_gateway.cyber94_vulnerability_scanner_ig_tf.id

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/vpc/main.tf:1

## TerraformAWS:VPC:Internet_Gateway To TerraformAWS:VPC:Route_Table
link

```
# @connects #ig to #rt with link
resource "aws_route_table" "cyber94_vulnerability_scanner_rt_tf"{
  vpc_id = aws_vpc.cyber94_vulnerability_scanner_vpc_tf.id
  route {
    cidr_block = "0.0.0.0/0"
    gateway_id = aws_internet_gateway.cyber94_vulnerability_scanner_ig_tf.id

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/vpc/main.tf:1

## TerraformAWS:VPC:Route_Table To TerraformAWS:VPC:NACl_App:Subnet_App
link

```
# @connects #rt to #subnet_app with link
resource "aws_route_table_association" "cyber94_vulnerability_scanner_rt_assoc_app_tf" {
    subnet_id = aws_subnet.cyber94_vulnerability_scanner_subnet_app_tf.id
    route_table_id = var.var_internet_rt
}


```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/app_subnet/main.tf:1

## TerraformAWS:VPC:NACl_App:Subnet_App To TerraformAWS:VPC:Route_Table
link

```
# @connects #subnet_app to #rt with link
resource "aws_route_table_association" "cyber94_vulnerability_scanner_rt_assoc_app_tf" {
    subnet_id = aws_subnet.cyber94_vulnerability_scanner_subnet_app_tf.id
    route_table_id = var.var_internet_rt
}


```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/app_subnet/main.tf:1

## TerraformAWS:VPC:NACl_App To TerraformAWS:VPC:NACl_App:Subnet_App
HTTP,HTTPs

```
# @connects #nacl_app to #subnet_app with HTTP,HTTPs
resource "aws_network_acl" "cyber94_vulnerability_scanner_ncal_app_tf"{
  vpc_id = var.var_aws_vpc_id

  egress {
       protocol   = "-1"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/app_subnet/main.tf:1

## TerraformAWS:VPC:NACl_App:Subnet_App To TerraformAWS:VPC:NACl_App
HTTP,HTTPs

```
# @connects #subnet_app to #nacl_app with HTTP,HTTPs
resource "aws_network_acl" "cyber94_vulnerability_scanner_ncal_app_tf"{
  vpc_id = var.var_aws_vpc_id

  egress {
       protocol   = "-1"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/app_subnet/main.tf:1

## TerraformAWS:VPC:NACl_App To TerraformAWS:VPC:NACl_Database
SQL_Querry

```
# @connects #nacl_app to #nacl_db with SQL_Querry
resource "aws_network_acl" "cyber94_vulnerability_scanner_ncal_app_tf"{
  vpc_id = var.var_aws_vpc_id

  egress {
       protocol   = "-1"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/app_subnet/main.tf:1

## TerraformAWS:VPC:NACl_Database To TerraformAWS:VPC:NACl_App
SQL_Response

```
# @connects #nacl_db to #nacl_app with SQL_Response
resource "aws_network_acl" "cyber94_vulnerability_scanner_ncal_app_tf"{
  vpc_id = var.var_aws_vpc_id

  egress {
       protocol   = "-1"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/app_subnet/main.tf:1

## TerraformAWS:VPC:NACl_Proxy:Subnet_Proxy:Security_Group_Proxy To TerraformAWS:VPC:NACl_Proxy:Subnet_Proxy:Security_Group_Proxy:EC2_Instance_Proxy
SSH,HTTP,HTTP

```
# @connects #sg_proxy to #ec2_proxy with SSH,HTTP,HTTP
resource "aws_instance" "cyber94_vulnerability_scanner_nginx"{
  ami = "ami-0943382e114f188e8"
  instance_type = "t2.micro"
  key_name = "cyber94-bdeadfield"
  associate_public_ip_address = true

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/nginx_server/main.tf:1

## TerraformAWS:VPC:NACl_Proxy:Subnet_Proxy:Security_Group_Proxy:EC2_Instance_Proxy To TerraformAWS:VPC:NACl_Proxy:Subnet_Proxy:Security_Group_Proxy
HTTP,HTTPs,SQL

```
# @connects #ec2_proxy to #sg_proxy with HTTP,HTTPs,SQL
resource "aws_instance" "cyber94_vulnerability_scanner_nginx"{
  ami = "ami-0943382e114f188e8"
  instance_type = "t2.micro"
  key_name = "cyber94-bdeadfield"
  associate_public_ip_address = true

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/nginx_server/main.tf:1

## TerraformAWS:VPC:NACl_Proxy:Subnet_Proxy To TerraformAWS:VPC:NACl_Proxy:Subnet_Proxy:Security_Group_Proxy
SSH,HTTP,HTTPs,Ephemeral

```
# @connects #subnet_proxy to #sg_proxy with SSH,HTTP,HTTPs,Ephemeral
resource "aws_security_group" "cyber94_vulnerability_scanner_sg_nginx_tf"{
  name = "cyber94_vulnerability_scanner_sg_nginx"
  description = "Allow Web inbound traffic"
  vpc_id = var.var_aws_vpc_id


```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/nginx_server/main.tf:1

## TerraformAWS:VPC:NACl_Proxy:Subnet_Proxy:Security_Group_Proxy To TerraformAWS:VPC:NACl_Proxy:Subnet_Proxy
SSH,HTTP,HTTPs,Ephemeral

```
# @connects #sg_proxy to #subnet_proxy with SSH,HTTP,HTTPs,Ephemeral
resource "aws_security_group" "cyber94_vulnerability_scanner_sg_nginx_tf"{
  name = "cyber94_vulnerability_scanner_sg_nginx"
  description = "Allow Web inbound traffic"
  vpc_id = var.var_aws_vpc_id


```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/nginx_server/main.tf:1

## TerraformAWS:VPC:Route_Table To TerraformAWS:VPC:NACl_Proxy:Subnet_Proxy
link

```
# @connects #rt to #subnet_proxy with link
resource "aws_route_table_association" "cyber94_vulnerability_scanner_rt_assoc_nginx_tf" {
    subnet_id = aws_subnet.cyber94_vulnerability_scanner_subnet_nginx_tf.id
    route_table_id = var.var_internet_rt
}


```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/nginx_subnet/main.tf:1

## TerraformAWS:VPC:NACl_Proxy:Subnet_Proxy To TerraformAWS:VPC:Route_Table
link

```
# @connects #subnet_proxy to #rt with link
resource "aws_route_table_association" "cyber94_vulnerability_scanner_rt_assoc_nginx_tf" {
    subnet_id = aws_subnet.cyber94_vulnerability_scanner_subnet_nginx_tf.id
    route_table_id = var.var_internet_rt
}


```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/nginx_subnet/main.tf:1

## TerraformAWS:VPC:NACl_Proxy To TerraformAWS:VPC:NACl_Proxy:Subnet_Proxy
SSH,HTTPs,Ephemeral Ports

```
# @connects #nacl_proxy to #subnet_proxy with SSH,HTTPs,Ephemeral Ports
resource "aws_network_acl" "cyber94_vulnerability_scanner_ncal_nginx_tf"{
  vpc_id = var.var_aws_vpc_id

  egress {
      protocol   = "-1"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/nginx_subnet/main.tf:1

## TerraformAWS:VPC:NACl_Proxy:Subnet_Proxy To TerraformAWS:VPC:NACl_Proxy
HTTP,HTTPs,Ephemeral Ports

```
# @connects #subnet_proxy to #nacl_proxy with HTTP,HTTPs,Ephemeral Ports
resource "aws_network_acl" "cyber94_vulnerability_scanner_ncal_nginx_tf"{
  vpc_id = var.var_aws_vpc_id

  egress {
      protocol   = "-1"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/nginx_subnet/main.tf:1

## TerraformAWS:VPC:NACl_Proxy To TerraformAWS:VPC:NACl_App
HTTP,HTTPs

```
# @connects #nacl_proxy to #nacl_app with HTTP,HTTPs
resource "aws_network_acl" "cyber94_vulnerability_scanner_ncal_nginx_tf"{
  vpc_id = var.var_aws_vpc_id

  egress {
      protocol   = "-1"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/nginx_subnet/main.tf:1

## TerraformAWS:VPC:NACl_App To TerraformAWS:VPC:NACl_Proxy
HTTP,HTTPs

```
# @connects #nacl_app to #nacl_proxy with HTTP,HTTPs
resource "aws_network_acl" "cyber94_vulnerability_scanner_ncal_nginx_tf"{
  vpc_id = var.var_aws_vpc_id

  egress {
      protocol   = "-1"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/nginx_subnet/main.tf:1

## TerraformAWS:VPC:NACl_Database:Subnet_Database:Security_Group_Database To TerraformAWS:VPC:NACl_Database:Subnet_Database:Security_Group_Database:EC2_Instance_Database
SQL_Querry

```
# @connects #sg_db to #ec2_db with SQL_Querry


resource "aws_instance" "cyber94_vulnerability_scanner_db"{
  ami = "ami-0d1c7c4de1f4cdc9a"
  instance_type = "t2.micro"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/database_server/main.tf:1

## TerraformAWS:VPC:NACl_Database:Subnet_Database:Security_Group_Database:EC2_Instance_Database To TerraformAWS:VPC:NACl_Database:Subnet_Database:Security_Group_Database
SQL_Response

```
# @connects #ec2_db to #sg_db with SQL_Response


resource "aws_instance" "cyber94_vulnerability_scanner_db"{
  ami = "ami-0d1c7c4de1f4cdc9a"
  instance_type = "t2.micro"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/database_server/main.tf:1

## TerraformAWS:VPC:NACl_Database:Subnet_Database To TerraformAWS:VPC:NACl_Database:Subnet_Database:Security_Group_Database
SQL

```
# @connects #subnet_db to #sg_db with SQL
resource "aws_security_group" "cyber94_vulnerability_scanner_sg_db_tf"{
  name = "cyber94_vulnerability_scanner_sg_db"
  description = "Allow Web inbound traffic"
  vpc_id = var.var_aws_vpc_id


```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/database_server/main.tf:1

## TerraformAWS:VPC:NACl_Database:Subnet_Database:Security_Group_Database To TerraformAWS:VPC:NACl_Database:Subnet_Database
SQL

```
# @connects #sg_db to #subnet_db with SQL
resource "aws_security_group" "cyber94_vulnerability_scanner_sg_db_tf"{
  name = "cyber94_vulnerability_scanner_sg_db"
  description = "Allow Web inbound traffic"
  vpc_id = var.var_aws_vpc_id


```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/database_server/main.tf:1

## TerraformAWS:VPC:NACl_App:Subnet_App:Security_Group_App To TerraformAWS:VPC:NACl_App:Subnet_App:Security_Group_App:EC2_Instance_App
HTTP,HTTPs

```
# @connects #sg_app to #ec2_app with HTTP,HTTPs






```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/app_server/main.tf:1

## TerraformAWS:VPC:NACl_App:Subnet_App:Security_Group_App:EC2_Instance_App To TerraformAWS:VPC:NACl_App:Subnet_App:Security_Group_App
HTTP,HTTPs

```
# @connects #ec2_app to #sg_app with HTTP,HTTPs






```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/app_server/main.tf:1

## TerraformAWS:VPC:NACl_App:Subnet_App To TerraformAWS:VPC:NACl_App:Subnet_App:Security_Group_App
HTTP,HTTPs

```
# @connects #subnet_app to #sg_app with HTTP,HTTPs
resource "aws_security_group" "cyber94_vulnerability_scanner_sg_app_tf"{
  name = "cyber94_vulnerability_scanner_sg_app"
  description = "Allow Web inbound traffic"
  vpc_id = var.var_aws_vpc_id


```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/app_server/main.tf:1

## TerraformAWS:VPC:NACl_App:Subnet_App:Security_Group_App To TerraformAWS:VPC:NACl_App:Subnet_App
HTTP,HTTPs

```
# @connects #sg_app to #subnet_app with HTTP,HTTPs
resource "aws_security_group" "cyber94_vulnerability_scanner_sg_app_tf"{
  name = "cyber94_vulnerability_scanner_sg_app"
  description = "Allow Web inbound traffic"
  vpc_id = var.var_aws_vpc_id


```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/app_server/main.tf:1

## TerraformAWS:VPC:NACl_Database To TerraformAWS:VPC:NACl_Database:Subnet_Database
SQL

```
# @connects #nacl_db to #subnet_db with SQL
resource "aws_network_acl" "cyber94_vulnerability_scanner_ncal_db_tf"{
  vpc_id = var.var_aws_vpc_id

  egress {
       protocol   = "tcp"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/database_subnet/main.tf:1

## TerraformAWS:VPC:NACl_Database:Subnet_Database To TerraformAWS:VPC:NACl_Database
SQL

```
# @connects #subnet_db to #nacl_db with SQL
resource "aws_network_acl" "cyber94_vulnerability_scanner_ncal_db_tf"{
  vpc_id = var.var_aws_vpc_id

  egress {
       protocol   = "tcp"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/database_subnet/main.tf:1

## TerraformAWS:VPC:NACl_Bastion:Subnet_Bastion:Security_Group_Bastion To TerraformAWS:VPC:NACl_Bastion:Subnet_Bastion:Security_Group_Bastion:EC2_Instance_Bastion
SSH

```
# @connects #sg_bastion to #ec2_bastion with SSH



resource "aws_instance" "cyber94_vulnerability_scanner_bastion"{
  ami = "ami-0943382e114f188e8"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/bastion_server/main.tf:1

## TerraformAWS:VPC:NACl_Bastion:Subnet_Bastion:Security_Group_Bastion:EC2_Instance_Bastion To TerraformAWS:VPC:NACl_Bastion:Subnet_Bastion:Security_Group_Bastion
HTTP,HTTPs

```
# @connects #ec2_bastion to #sg_bastion with HTTP,HTTPs



resource "aws_instance" "cyber94_vulnerability_scanner_bastion"{
  ami = "ami-0943382e114f188e8"

```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/bastion_server/main.tf:1

## TerraformAWS:VPC:NACl_Bastion:Subnet_Bastion To TerraformAWS:VPC:NACl_Bastion:Subnet_Bastion:Security_Group_Bastion
SSH

```
# @connects #subnet_bastion to #sg_bastion with SSH
resource "aws_security_group" "cyber94_vulnerability_scanner_sg_bastion_tf"{
  name = "cyber94_vulnerability_scanner_sg_bastion"
  description = "Allow Web inbound traffic"
  vpc_id = var.var_aws_vpc_id


```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/bastion_server/main.tf:1

## TerraformAWS:VPC:NACl_Bastion:Subnet_Bastion:Security_Group_Bastion To TerraformAWS:VPC:NACl_Bastion:Subnet_Bastion
SSH,HTTP,HTTPs

```
# @connects #sg_bastion to #subnet_bastion with SSH,HTTP,HTTPs
resource "aws_security_group" "cyber94_vulnerability_scanner_sg_bastion_tf"{
  name = "cyber94_vulnerability_scanner_sg_bastion"
  description = "Allow Web inbound traffic"
  vpc_id = var.var_aws_vpc_id


```
/home/kali/cyber/projects/enterprise_vulnerability_checker/terraform/modules/bastion_server/main.tf:1


# Components

## TerraformAWS:VPC:NACl_Database:Subnet_Database:Security_Group_Database:EC2_Instance_Database

## TerraformAWS:VPC:NACl_App:Subnet_App:Security_Group_App:EC2_Instance_App

## TerraformAWS:VPC:NACl_Bastion:Subnet_Bastion:Security_Group_Bastion:EC2_Instance_Bastion

## TerraformAWS:VPC:Route_Table

## TerraformAWS:VPC:NACl_Bastion:Subnet_Bastion

## TerraformAWS:VPC:NACl_Bastion

## TerraformAWS:VPC:NACl_Database

## Internet

## Internet:developer_Computer

## TerraformAWS:VPC:Internet_Gateway

## TerraformAWS:VPC:NACl_App:Subnet_App

## TerraformAWS:VPC:NACl_App

## TerraformAWS:VPC:NACl_Proxy:Subnet_Proxy:Security_Group_Proxy

## TerraformAWS:VPC:NACl_Proxy:Subnet_Proxy:Security_Group_Proxy:EC2_Instance_Proxy

## TerraformAWS:VPC:NACl_Proxy:Subnet_Proxy

## TerraformAWS:VPC:NACl_Proxy

## TerraformAWS:VPC:NACl_Database:Subnet_Database:Security_Group_Database

## TerraformAWS:VPC:NACl_Database:Subnet_Database

## TerraformAWS:VPC:NACl_App:Subnet_App:Security_Group_App

## TerraformAWS:VPC:NACl_Bastion:Subnet_Bastion:Security_Group_Bastion


# Threats

## Ip exposure


## Port sniffing for open ports


## Access to ec2_app allows access to database server


## Intruder ssh connection


## Out of service



# Controls

## Not connected to public ip address or route table

## Using dns for proxy server

## Only listen on needed ports

## Only allow ssh connections to ec2_app server from specific ip addresses

## Nacl and security group ip check
