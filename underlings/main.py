import mysql.connector

def create_table():
     mydb = mysql.connector.connect(
     host="34.243.231.223",
       user="root",
     password="my_secret_password",
     database="projects"
     )
     mycursor = mydb.cursor()
     mycursor.execute("CREATE TABLE underlings (id INT AUTO_INCREMENT PRIMARY KEY, project VARCHAR(255), underling VARCHAR(255), underlingemail VARCHAR(255));")
     mydb.commit()
     mydb.close()

def add_data(project,underling,underlingemail):
    mydb = mysql.connector.connect(
    host="34.243.231.223",
      user="root",
    password="my_secret_password",
    database="projects"
    )
    mycursor = mydb.cursor()
    mycursor.execute(f"INSERT INTO underlings (project, underling, underlingemail) VALUES ('{project}','{underling}','{underlingemail}');")
    mydb.commit()
    mydb.close()

def delete_project(project):
    mydb = mysql.connector.connect(
    host="34.243.231.223",
      user="root",
    password="my_secret_password",
    database="projects"
    )
    mycursor = mydb.cursor()
    mycursor.execute(f"DELETE FROM underlings WHERE project = '{project}';")
    mydb.commit()
    mydb.close()

def get_underling_email(project):
    mydb = mysql.connector.connect(
    host="34.243.231.223",
      user="root",
    password="my_secret_password",
    database="projects"
    )
    mycursor = mydb.cursor()
    mycursor.execute(f"SELECT underlingemail FROM underlings WHERE project='{project}';")
    data = mycursor.fetchall()
    list = []
    for i in data:
        if i[0] not in list:
            list.append(i[0])

    mydb.close()
    return list

if __name__ == "__main__":
    #create_table()
    #add_data('Azure','George','George@jungle.com')
    #add_data('Azure','Lewis','Lewis@thenews.com')
    #add_data('AWS','Jonathan','Jonathan@dontknow.com')
    #add_data('AWS','Abdulaleem','Abdulaleem@hishouse.com')
    print(get_underling_email('Azure'))
    print(get_underling_email('AWS'))
