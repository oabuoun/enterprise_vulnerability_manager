import mysql.connector
from sql_init import ProjectDB
mydb=userDB()
mycursor = mydb.cursor

def create_table():
     mycursor.execute("CREATE TABLE underlings (id INT AUTO_INCREMENT PRIMARY KEY, project VARCHAR(255), underling VARCHAR(255), underlingemail VARCHAR(255));")
     mydb.connection.commit()

def add_underling(project,underling,underlingemail):
    mycursor.execute(f"INSERT INTO underlings (project, underling, underlingemail) VALUES ('{project}','{underling}','{underlingemail}');")
    mydb.connection.commit()

def delete_project_underling(project):
    mycursor.execute(f"DELETE FROM underlings WHERE project = '{project}';")
    mydb.connection.commit()

def delete_underling(project, underling):
    mycursor.execute(f"DELETE FROM underlings WHERE project = '{project}' AND underling = '{underling}';")
    mydb.connection.commit()

def get_underling_email(project):
    mycursor.execute(f"SELECT underlingemail FROM underlings WHERE project='{project}';")
    data = mycursor.fetchall()
    list = []
    for i in data:
        if i[0] not in list:
            list.append(i[0])
    return list

#if __name__ == "__main__":
    #create_table()
    #add_data('Azure','George','George@jungle.com')
    #add_data('Azure','Lewis','Lewis@thenews.com')
    #add_data('AWS','Jonathan','Jonathan@dontknow.com')
    #add_data('AWS','Abdulaleem','Abdulaleem@hishouse.com')
    #print(get_underling_email('Azure'))
    #print(get_underling_email('AWS'))
