import mysql.connector
from sql_init import ProjectDB
#class ProjectCommands:
def create_database(self):
    mydb = mysql.connector.connect(
    host="34.243.231.223",
      user="root",
    password="my_secret_password",
    )
    mycursor = mydb.cursor()
    mycursor.execute("CREATE DATABASE projects;")
    mydb.commit()
    mydb.close()

def create_table(self):
     mydb = mysql.connector.connect(
     host="34.243.231.223",
       user="root",
     password="my_secret_password",
     database="projects"
     )
     mycursor = mydb.cursor()
     mycursor.execute("CREATE TABLE projecttable (id INT AUTO_INCREMENT PRIMARY KEY, project VARCHAR(255), product VARCHAR(255), username VARCHAR(255));")
     mydb.commit()
     mydb.close()

def add_data(project,product,username):
    mydb = mysql.connector.connect(
    host="34.243.231.223",
      user="root",
    password="my_secret_password",
    database="projects"
    )
    mycursor = mydb.cursor()
    mycursor.execute(f"INSERT INTO projecttable (project, product, username) VALUES ('{project}','{product}','{username}');")
    mydb.commit()
    mydb.close()

def delete_project(project):
    mydb = mysql.connector.connect(
    host="34.243.231.223",
      user="root",
    password="my_secret_password",
    database="projects"
    )
    mycursor = mydb.cursor()
    mycursor.execute(f"DELETE FROM projecttable WHERE project = '{project}';")
    mydb.commit()
    mydb.close()

def delete_product(project,product):
    mydb = mysql.connector.connect(
    host="34.243.231.223",
      user="root",
    password="my_secret_password",
    database="projects"
    )
    mycursor = mydb.cursor()
    mycursor.execute(f"DELETE FROM projecttable WHERE project = '{project}' AND product = '{product}';")
    mydb.commit()
    mydb.close()

def delete_table(self):
    mydb = mysql.connector.connect(
    host="34.243.231.223",
      user="root",
    password="my_secret_password",
    database="projects"
    )
    mycursor = mydb.cursor()
    mycursor.execute(f"DROP TABLE projecttable ;")
    mydb.commit()
    mydb.close()

def get_projects_names(user):
    mydb = mysql.connector.connect(
    host="34.243.231.223",
      user="root",
    password="my_secret_password",
    database="projects"
    )
    mycursor = mydb.cursor()
    mycursor.execute(f"SELECT project AND product FROM projecttable where username = '{user}';")
    data = mycursor.fetchall()
    list = []
    for i in data:
        list.append(i[0])
    return list

#if __name__ == "__main__":
        #create_database()
        #create_table()
    #ProjectCommands.add_data('Azure','Microsoft','Daniel')
        #delete_project('Azure')
        #delete_product('Azure','Microsoft')
    #delete_table()
