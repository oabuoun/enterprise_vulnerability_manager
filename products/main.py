import mysql.connector

def create_database():
    mydb = mysql.connector.connect(
    host="34.243.231.223",
      user="root",
    password="my_secret_password",
    )
    mycursor = mydb.cursor()
    mycursor.execute("CREATE DATABASE projects;")
    mydb.commit()
    mydb.close()



def create_table():
     mydb = mysql.connector.connect(
     host="34.243.231.223",
       user="root",
     password="my_secret_password",
     database="projects"
     )
     mycursor = mydb.cursor()
     mycursor.execute("CREATE TABLE projecttable (id INT AUTO_INCREMENT PRIMARY KEY, project VARCHAR(255), product VARCHAR(255), username VARCHAR(255));")
     mydb.commit()
     mydb.close()

def add_data(project,product,username):
    mydb = mysql.connector.connect(
    host="34.243.231.223",
      user="root",
    password="my_secret_password",
    database="projects"
    )
    mycursor = mydb.cursor()
    mycursor.execute(f"INSERT INTO projecttable (project, product, username) VALUES ('{project}','{product}','{username}');")
    mydb.commit()
    mydb.close()

def delete_project(project):
    mydb = mysql.connector.connect(
    host="34.243.231.223",
      user="root",
    password="my_secret_password",
    database="projects"
    )
    mycursor = mydb.cursor()
    mycursor.execute(f"DELETE FROM projecttable WHERE project = '{project}';")
    mydb.commit()
    mydb.close()

def delete_product(project,product):
    mydb = mysql.connector.connect(
    host="34.243.231.223",
      user="root",
    password="my_secret_password",
    database="projects"
    )
    mycursor = mydb.cursor()
    mycursor.execute(f"DELETE FROM projecttable WHERE project = '{project}' AND product = '{product}';")
    mydb.commit()
    mydb.close()

def delete_table():
    mydb = mysql.connector.connect(
    host="34.243.231.223",
      user="root",
    password="my_secret_password",
    database="projects"
    )
    mycursor = mydb.cursor()
    mycursor.execute("DROP TABLE projecttable ;")
    mydb.commit()
    mydb.close()

def get_product_names():
    mydb = mysql.connector.connect(
    host="34.243.231.223",
      user="root",
    password="my_secret_password",
    database="projects"
    )
    mycursor = mydb.cursor()
    mycursor.execute("SELECT product FROM projecttable;")
    data = mycursor.fetchall()
    list = []
    for i in data:
        if i[0] not in list:
            list.append(i[0])

    mydb.close()
    return list

def get_projects_names(user):
    mydb = mysql.connector.connect(
    host="34.243.231.223",
      user="root",
    password="my_secret_password",
    database="projects"
    )
    mycursor = mydb.cursor()
    mycursor.execute(f"SELECT project AND product FROM projecttable where username = '{user}';")
    data = mycursor.fetchall()
    list = []
    for i in data:
        list.append(i)
    mydb.close()
    return list

def get_projects_from_product(product):
    mydb = mysql.connector.connect(
    host="34.243.231.223",
      user="root",
    password="my_secret_password",
    database="projects"
    )
    mycursor = mydb.cursor()
    mycursor.execute(f"SELECT project FROM projecttable where product = '{product}';")
    data = mycursor.fetchall()
    list = []
    for i in data:
        list.append(i)
    mydb.close()
    return list

def get_username_from_product(product):
    mydb = mysql.connector.connect(
    host="34.243.231.223",
      user="root",
    password="my_secret_password",
    database="projects"
    )
    mycursor = mydb.cursor()
    mycursor.execute(f"SELECT username FROM projecttable where product = '{product}';")
    data = mycursor.fetchall()
    list = []
    for i in data:
        list.append(i)
    mydb.close()
    return list

if __name__ == "__main__":
    #create_database()
    #create_table()
    #add_data('Azure','Microsoft','Daniel')
    #add_data('Azure2','Linux','Daniel')
    # add_data('Azure2','Apple','Daniel')

    print(get_product_names())

    #delete_project('Azure')

    #delete_product('Azure','Microsoft')
    #delete_table()
